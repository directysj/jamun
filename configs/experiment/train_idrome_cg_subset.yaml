# @package _global_

defaults:
  - _self_

compute_average_squared_distance_from_data: true

model:
  sigma_distribution:
    _target_: jamun.distributions.ConstantSigma
    sigma: 0.2
  max_radius: 1.5
  optim:
    lr: 0.002
  use_torch_compile: true

callbacks:
  viz:
    sigma_list: ["${model.sigma_distribution.sigma}"]

data:
  datamodule:
    num_workers: 1
    batch_size: 10
    datasets:
      train:
        _target_: jamun.data.parse_datasets_from_directory_new
        root: "/homefs/home/daigavaa/IDRome_v4_subset/"
        traj_pattern: "^(.*)/traj.xtc"
        topology_pattern: "^(.*)/top.pdb"
        coarse_grained: true
        filter_codes:
          - Q0_47_21_1_1496 # length 1496
          # - P1_00_70_584_1586 # length 1003
          # - Q9_C0_H5_101_700 # length 600
          # - P6_05_07_185_584 # length 400
        # filter_codes_csv: "/homefs/home/daigavaa/IDRome_v4_subset/train.csv"
        # filter_codes_csv_header: "code"


      val:
        _target_: jamun.data.parse_datasets_from_directory_new
        root: "/homefs/home/daigavaa/IDRome_v4_subset/"
        traj_pattern: "^(.*)/traj.xtc"
        topology_pattern: "^(.*)/top.pdb"
        coarse_grained: true
        subsample: 100
        filter_codes:
          - Q0_47_21_1_1496


      test:
        _target_: jamun.data.parse_datasets_from_directory_new
        root: "/homefs/home/daigavaa/IDRome_v4_subset/"
        traj_pattern: "^(.*)/traj.xtc"
        topology_pattern: "^(.*)/top.pdb"
        subsample: 100
        filter_codes:
          - A0_A1_W2_PPF3_72_112


trainer:
  val_check_interval: 0.1
  limit_val_batches: 1000
  max_epochs: 10


# resume_from_checkpoint:
#   wandb_train_run_path: prescient-design/jamun/dea4gbvs
#   checkpoint_type: last

logger:
  wandb:
    group: train_idrome_cg
